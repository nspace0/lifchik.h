#include <errno.h>
#include <stdio.h>
#include <string.h>

#ifdef __APPLE__
#define MAX_ERRORS 133
#define OS "macOS"
static const char* error_messages[] = {
    [0] = "Success",
    [1] = "Operation not permitted",
    [2] = "No such file or directory",
    [3] = "No such process",
    [4] = "Interrupted system call",
    [5] = "Input/output error",
    [6] = "No such device or address",
    [7] = "Argument list too long",
    [8] = "Exec format error",
    [9] = "Bad file descriptor",
    [10] = "No child processes",
    [11] = "Resource temporarily unavailable",
    [12] = "Cannot allocate memory",
    [13] = "Permission denied",
    [14] = "Bad address",
    [15] = "Block device required",
    [16] = "Device or resource busy",
    [17] = "File exists",
    [18] = "Invalid cross-device link",
    [19] = "No such device",
    [20] = "Not a directory",
    [21] = "Is a directory",
    [22] = "Invalid argument",
    [23] = "Too many open files in system",
    [24] = "Too many open files",
    [25] = "Inappropriate ioctl for device",
    [26] = "Text file busy",
    [27] = "File too large",
    [28] = "No space left on device",
    [29] = "Illegal seek",
    [30] = "Read-only file system",
    [31] = "Too many links",
    [32] = "Broken pipe",
    [33] = "Numerical argument out of domain",
    [34] = "Numerical result out of range",
    [35] = "Resource deadlock avoided",
    [36] = "File name too long",
    [37] = "No locks available",
    [38] = "Function not implemented",
    [39] = "Directory not empty",
    [40] = "Too many levels of symbolic links",
    [41] = "No message of desired type",
    [42] = "Identifier removed",
    [43] = "Channel number out of range",
    [44] = "Level 2 not synchronized",
    [45] = "Level 3 halted",
    [46] = "Level 3 reset",
    [47] = "Link number out of range",
    [48] = "Protocol driver not attached",
    [49] = "No CSI structure available",
    [50] = "Level 2 halted",
    [51] = "Invalid exchange",
    [52] = "Invalid request descriptor",
    [53] = "Exchange full",
    [54] = "No anode",
    [55] = "Invalid request code",
    [56] = "Invalid slot",
    [57] = "File locking deadlock error",
    [58] = "Bad font file format",
    [59] = "Device not a stream",
    [60] = "No data available",
    [61] = "Timer expired",
    [62] = "Out of streams resources",
    [63] = "Machine is not on the network",
    [64] = "Package not installed",
    [65] = "Object is remote",
    [66] = "Link has been severed",
    [67] = "Advertise error",
    [68] = "Srmount error",
    [69] = "Communication error on send",
    [70] = "Protocol error",
    [71] = "Multihop attempted",
    [72] = "RFS specific error",
    [73] = "Not a data message",
    [74] = "Value too large for defined data type",
    [75] = "Given log. name not unique",
    [76] = "f.d. invalid for this operation",
    [77] = "Remote address changed",
    [78] = "Can't access a needed shared lib",
    [79] = "Accessing a corrupted shared lib",
    [80] = ".lib section in a.out corrupted",
    [81] = "Attempting to link in too many libs",
    [82] = "Attempting to exec a shared library",
    [83] = "Illegal byte sequence",
    [84] = "Interrupted system call should be restarted",
    [85] = "Streams pipe error",
    [86] = "Too many users",
    [87] = "Socket operation on non-socket",
    [88] = "Destination address required",
    [89] = "Message too long",
    [90] = "Protocol wrong type for socket",
    [91] = "Protocol not available",
    [92] = "Protocol not supported",
    [93] = "Socket type not supported",
    [94] = "Operation not supported on transport endpoint",
    [95] = "Protocol family not supported",
    [96] = "Address family not supported by protocol",
    [97] = "Address already in use",
    [98] = "Cannot assign requested address",
    [99] = "Network is down",
    [100] = "Network is unreachable",
    [101] = "Network dropped connection because of reset",
    [102] = "Software caused connection abort",
    [103] = "Connection reset by peer",
    [104] = "No buffer space available",
    [105] = "Transport endpoint is already connected",
    [106] = "Transport endpoint is not connected",
    [107] = "Cannot send after transport endpoint shutdown",
    [108] = "Too many references: cannot splice",
    [109] = "Connection timed out",
    [110] = "Connection refused",
    [111] = "Host is down",
    [112] = "No route to host",
    [113] = "Operation already in progress",
    [114] = "Operation now in progress",
    [115] = "Stale NFS file handle",
    [116] = "Structure needs cleaning",
    [117] = "Not a XENIX named type file",
    [118] = "No XENIX semaphores available",
    [119] = "Is a named type file",
    [120] = "Remote I/O error",
    [121] = "Quota exceeded",
    [122] = "No medium found",
    [123] = "Wrong medium type",
    [124] = "Operation Canceled",
    [125] = "Required key not available",
    [126] = "Key has expired",
    [127] = "Key has been revoked",
    [128] = "Key was rejected by service",
    [129] = "Owner died",
    [130] = "State not recoverable"};
#elif __linux__
#define MAX_ERRORS 133
#define OS "Linux"
static const char* error_messages[] = {
    [0] = "Success",
    [1] = "Operation not permitted",
    [2] = "No such file or directory",
    [3] = "No such process",
    [4] = "Interrupted system call",
    [5] = "Input/output error",
    [6] = "No such device or address",
    [7] = "Argument list too long",
    [8] = "Exec format error",
    [9] = "Bad file descriptor",
    [10] = "No child processes",
    [11] = "Resource temporarily unavailable",
    [12] = "Cannot allocate memory",
    [13] = "Permission denied",
    [14] = "Bad address",
    [15] = "Block device required",
    [16] = "Device or resource busy",
    [17] = "File exists",
    [18] = "Invalid cross-device link",
    [19] = "No such device",
    [20] = "Not a directory",
    [21] = "Is a directory",
    [22] = "Invalid argument",
    [23] = "Too many open files in system",
    [24] = "Too many open files",
    [25] = "Inappropriate ioctl for device",
    [26] = "Text file busy",
    [27] = "File too large",
    [28] = "No space left on device",
    [29] = "Illegal seek",
    [30] = "Read-only file system",
    [31] = "Too many links",
    [32] = "Broken pipe",
    [33] = "Numerical argument out of domain",
    [34] = "Numerical result out of range",
    [35] = "Resource deadlock avoided",
    [36] = "File name too long",
    [37] = "No locks available",
    [38] = "Function not implemented",
    [39] = "Directory not empty",
    [40] = "Too many levels of symbolic links",
    [41] = "No message of desired type",
    [42] = "Identifier removed",
    [43] = "Channel number out of range",
    [44] = "Level 2 not synchronized",
    [45] = "Level 3 halted",
    [46] = "Level 3 reset",
    [47] = "Link number out of range",
    [48] = "Protocol driver not attached",
    [49] = "No CSI structure available",
    [50] = "No CSI structure available",
    [51] = "Invalid exchange",
    [52] = "Invalid request descriptor",
    [53] = "Exchange full",
    [54] = "No anode",
    [55] = "Invalid request code",
    [56] = "Invalid slot",
    [57] = "File locking deadlock error",
    [58] = "Bad font file format",
    [59] = "Device not a stream",
    [60] = "No data available",
    [61] = "Timer expired",
    [62] = "Out of streams resources",
    [63] = "Machine is not on the network",
    [64] = "Package not installed",
    [65] = "Object is remote",
    [66] = "Link has been severed",
    [67] = "Advertise error",
    [68] = "Srmount error",
    [69] = "Communication error on send",
    [70] = "Protocol error",
    [71] = "Multihop attempted",
    [72] = "RFS specific error",
    [73] = "Not a data message",
    [74] = "Value too large for defined data type",
    [75] = "Given log. name not unique",
    [76] = "f.d. invalid for this operation",
    [77] = "Remote address changed",
    [78] = "Can't access a needed shared lib",
    [79] = "Accessing a corrupted shared lib",
    [80] = ".lib section in a.out corrupted",
    [81] = "Attempting to link in too many libs",
    [82] = "Attempting to exec a shared library",
    [83] = "Illegal byte sequence",
    [84] = "Interrupted system call should be restarted",
    [85] = "Streams pipe error",
    [86] = "Too many users",
    [87] = "Socket operation on non-socket",
    [88] = "Destination address required",
    [89] = "Message too long",
    [90] = "Protocol wrong type for socket",
    [91] = "Protocol not available",
    [92] = "Protocol not supported",
    [93] = "Socket type not supported",
    [94] = "Operation not supported on transport endpoint",
    [95] = "Protocol family not supported",
    [96] = "Address family not supported by protocol",
    [97] = "Address already in use",
    [98] = "Cannot assign requested address",
    [99] = "Network is down",
    [100] = "Network is unreachable",
    [101] = "Network dropped connection because of reset",
    [102] = "Software caused connection abort",
    [103] = "Connection reset by peer",
    [104] = "No buffer space available",
    [105] = "Transport endpoint is already connected",
    [106] = "Transport endpoint is not connected",
    [107] = "Cannot send after transport endpoint shutdown",
    [108] = "Too many references: cannot splice",
    [109] = "Connection timed out",
    [110] = "Connection refused",
    [111] = "Host is down",
    [112] = "No route to host",
    [113] = "Operation already in progress",
    [114] = "Operation now in progress",
    [115] = "Stale NFS file handle",
    [116] = "Structure needs cleaning",
    [117] = "Not a XENIX named type file",
    [118] = "No XENIX semaphores available",
    [119] = "Is a named type file",
    [120] = "Remote I/O error",
    [121] = "Quota exceeded",
    [122] = "No medium found",
    [123] = "Wrong medium type",
    [124] = "Operation Canceled",
    [125] = "Required key not available",
    [126] = "Key has expired",
    [127] = "Key has been revoked",
    [128] = "Key was rejected by service",
    [129] = "Owner died",
    [130] = "State not recoverable"};
#else
#error "Unsupported operating system"
#endif

const char* s21_strerror(int errnum) {
  static char unknown_error[50];
  if (errnum < 0 || errnum >= MAX_ERRORS) {
    snprintf(unknown_error, sizeof(unknown_error), "Unknown error %d", errnum);
    return unknown_error;
  } else {
    return error_messages[errnum];
  }
}
